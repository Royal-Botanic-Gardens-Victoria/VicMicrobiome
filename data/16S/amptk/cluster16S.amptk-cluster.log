[11/24/22 15:32:17]: /opt/miniconda3/miniconda3/envs/amptk/bin/amptk cluster -i ../data/16S/amptk/combined.demux.fq.gz -o cluster16S --uchime_ref 16S

[11/24/22 15:32:17]: OS: Ubuntu 18.10, 128 cores, ~ 1052 GB RAM. Python: 3.9.10
[11/24/22 15:32:17]: Python Modules: numpy v1.22.2, pandas v1.4.0, matplotlib v3.5.1, psutil v5.9.0, natsort v8.1.0, biopython v1.79, edlib v1.3.9, biom-format v2.1.10
[11/24/22 15:32:17]: AMPtk v1.5.4, VSEARCH v2.21.1
[11/24/22 15:32:17]: Loading FASTQ Records
[11/24/22 15:32:17]: vsearch --fastq_filter ../data/16S/amptk/combined.demux.fq.gz --fastaout cluster16S_tmp/cluster16S.orig.fa --fastq_qmax 55 --threads 1
[11/24/22 15:39:03]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading input file 100%
13607911 sequences kept (of which 0 truncated), 0 sequences discarded.

[11/24/22 15:39:23]: 13,607,911 reads (1.9 GB)
[11/24/22 15:39:23]: Quality Filtering, expected errors < 1.0
[11/24/22 15:39:23]: vsearch --fastq_filter ../data/16S/amptk/combined.demux.fq.gz --fastq_maxee 1.0 --fastqout cluster16S_tmp/cluster16S.EE1.0.filter.fq --fastaout cluster16S_tmp/cluster16S.EE1.0.filter.fa --fastq_qmax 55 --threads 1
[11/24/22 15:46:35]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading input file 100%
12644338 sequences kept (of which 0 truncated), 963573 sequences discarded.

[11/24/22 15:46:48]: 12,644,338 reads passed
[11/24/22 15:46:48]: De-replication (remove duplicate reads)
[11/24/22 15:46:48]: vsearch --derep_fulllength cluster16S_tmp/cluster16S.EE1.0.filter.fa --sizeout --output cluster16S_tmp/cluster16S.EE1.0.derep.fa --threads 1
[11/24/22 15:47:43]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Dereplicating file cluster16S_tmp/cluster16S.EE1.0.filter.fa 100%
5829011898 nt in 12644338 seqs, min 150, max 500, avg 461
Sorting 100%
6892009 unique sequences, avg cluster 1.8, median 1, max 34465
Writing FASTA output file 100%

[11/24/22 15:47:53]: 6,892,009 reads passed
[11/24/22 15:47:53]: vsearch --sortbysize cluster16S_tmp/cluster16S.EE1.0.derep.fa --minsize 2 --output cluster16S_tmp/cluster16S.EE1.0.sort.fa --threads 1
[11/24/22 15:48:05]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file cluster16S_tmp/cluster16S.EE1.0.derep.fa 100%
3177327107 nt in 6892009 seqs, min 150, max 500, avg 461
Getting sizes 100%
Sorting 100%
Median abundance: 3
Writing output 100%

[11/24/22 15:48:05]: Clustering OTUs (VSEARCH --cluster_smallmem)
[11/24/22 15:48:05]: vsearch --cluster_smallmem cluster16S_tmp/cluster16S.EE1.0.sort.fa --relabel OTU --usersort --sizeout --id 0.97 --centroids cluster16S_tmp/cluster16S.EE1.0.smallmem.otus.fa --threads 128
[11/24/22 15:50:18]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file cluster16S_tmp/cluster16S.EE1.0.sort.fa 100%
299056929 nt in 647976 seqs, min 150, max 500, avg 462
Masking 100%
Counting k-mers 100%
Clustering 100%
Sorting clusters 100%
Writing clusters 100%
Clusters: 87921 Size min 1, max 9877, avg 7.4
Singletons: 44340, 6.8% of seqs, 50.4% of clusters

[11/24/22 15:50:18]: De novo Chimera detection (VSEARCH --uchime_denovo)
[11/24/22 15:50:18]: vsearch --uchime_denovo cluster16S_tmp/cluster16S.EE1.0.smallmem.otus.fa --sizein --nonchimeras cluster16S_tmp/cluster16S.EE1.0.otus.fa
[11/24/22 15:56:20]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file cluster16S_tmp/cluster16S.EE1.0.smallmem.otus.fa 100%
38463874 nt in 87921 seqs, min 150, max 500, avg 437
Masking 100%
Sorting by abundance 100%
Counting k-mers 100%
Detecting chimeras 100%
Found 13917 (15.8%) chimeras, 73875 (84.0%) non-chimeras,
and 129 (0.1%) borderline sequences in 87921 unique sequences.
Taking abundance information into account, this corresponds to
67414 (10.4%) chimeras, 579980 (89.5%) non-chimeras,
and 582 (0.1%) borderline sequences in 647976 total sequences.

[11/24/22 15:56:20]: 73,875 OTUs
[11/24/22 15:56:20]: Cleaning up padding from OTUs
[11/24/22 15:56:21]: Chimera Filtering (VSEARCH) using 16S DB
[11/24/22 15:56:21]: vsearch --mindiv 1.0 --uchime_ref cluster16S_tmp/cluster16S.EE1.0.clean.otus.fa --db /opt/miniconda3/miniconda3/envs/amptk/lib/python3.9/site-packages/amptk/DB/16S.extracted.fa --nonchimeras cluster16S_tmp/cluster16S.EE1.0.uchime.otus.fa --threads 128
[11/24/22 15:56:51]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file /opt/miniconda3/miniconda3/envs/amptk/lib/python3.9/site-packages/amptk/DB/16S.extracted.fa 100%
18961589 nt in 13118 seqs, min 320, max 2205, avg 1445
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Detecting chimeras 100%
Found 1576 (2.1%) chimeras, 72173 (97.7%) non-chimeras,
and 126 (0.2%) borderline sequences in 73875 unique sequences.
Taking abundance information into account, this corresponds to
1576 (2.1%) chimeras, 72173 (97.7%) non-chimeras,
and 126 (0.2%) borderline sequences in 73875 total sequences.

[11/24/22 15:56:51]: 72,173 OTUs passed, 1,702 ref chimeras
[11/24/22 15:56:51]: Validating OTU orientation
[11/24/22 15:56:51]: vsearch --usearch_global cluster16S_tmp/cluster16S.EE1.0.sort.fa --db cluster16S_tmp/cluster16S.EE1.0.uchime.otus.fa --sizein --id 0.97 --strand plus --uc cluster16S_tmp/orient.uc
[11/24/22 15:58:47]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file cluster16S_tmp/cluster16S.EE1.0.uchime.otus.fa 100%
31124239 nt in 72173 seqs, min 150, max 500, avg 431
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Searching 100%
Matching unique query sequences: 579135 of 647976 (89.38%)
Matching total query sequences: 5922782 of 6400305 (92.54%)

[11/24/22 15:58:48]: vsearch --usearch_global cluster16S_tmp/cluster16S.EE1.0.uchime.otus.fa --db cluster16S_tmp/cluster16S.EE1.0.uchime.otus.fa --self --id 0.95 --strand both --userout cluster16S_tmp/orient-map.txt --userfields query+target+qstrand+id
[11/24/22 15:59:18]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file cluster16S_tmp/cluster16S.EE1.0.uchime.otus.fa 100%
31124239 nt in 72173 seqs, min 150, max 500, avg 431
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Searching 100%
Matching unique query sequences: 47207 of 72173 (65.41%)

[11/24/22 15:59:18]: Dropping 2 OTUs: OTU53744, OTU46170
[11/24/22 15:59:19]: 72,171 OTUs validated (2 dropped)
[11/24/22 15:59:19]: Mapping Reads to OTUs and Building OTU table
[11/24/22 15:59:19]: vsearch --usearch_global cluster16S_tmp/cluster16S.orig.fa --strand plus --id 0.97 --db cluster16S_tmp/cluster16S.passed.otus.fa --uc cluster16S_tmp/cluster16S.EE1.0.mapping.uc --otutabout cluster16S_tmp/cluster16S.EE1.0.otu_table.txt --threads 128
[11/24/22 16:49:05]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file cluster16S_tmp/cluster16S.passed.otus.fa 100%
31123861 nt in 72171 seqs, min 150, max 500, avg 431
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Searching 100%
Matching unique query sequences: 9500907 of 13607911 (69.82%)
Writing OTU table (classic) 100%

[11/24/22 16:49:07]: 9,500,907 reads mapped to OTUs (70%)
