[11/24/22 15:35:35]: /opt/miniconda3/miniconda3/envs/amptk/bin/amptk cluster -i ../data/ITS/amptk/combined.demux.fq.gz -o clusterITS --uchime_ref ITS

[11/24/22 15:35:35]: OS: Ubuntu 18.10, 128 cores, ~ 1052 GB RAM. Python: 3.9.10
[11/24/22 15:35:35]: Python Modules: numpy v1.22.2, pandas v1.4.0, matplotlib v3.5.1, psutil v5.9.0, natsort v8.1.0, biopython v1.79, edlib v1.3.9, biom-format v2.1.10
[11/24/22 15:35:35]: AMPtk v1.5.4, VSEARCH v2.21.1
[11/24/22 15:35:35]: Loading FASTQ Records
[11/24/22 15:35:35]: vsearch --fastq_filter ../data/ITS/amptk/combined.demux.fq.gz --fastaout clusterITS_tmp/clusterITS.orig.fa --fastq_qmax 55 --threads 1
[11/24/22 15:47:02]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading input file 100%
28800535 sequences kept (of which 0 truncated), 0 sequences discarded.

[11/24/22 15:47:35]: 28,800,535 reads (4.2 GB)
[11/24/22 15:47:35]: Quality Filtering, expected errors < 1.0
[11/24/22 15:47:35]: vsearch --fastq_filter ../data/ITS/amptk/combined.demux.fq.gz --fastq_maxee 1.0 --fastqout clusterITS_tmp/clusterITS.EE1.0.filter.fq --fastaout clusterITS_tmp/clusterITS.EE1.0.filter.fa --fastq_qmax 55 --threads 1
[11/24/22 16:02:23]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading input file 100%
14000999 sequences kept (of which 0 truncated), 14799536 sequences discarded.

[11/24/22 16:02:45]: 14,000,999 reads passed
[11/24/22 16:02:45]: De-replication (remove duplicate reads)
[11/24/22 16:02:45]: vsearch --derep_fulllength clusterITS_tmp/clusterITS.EE1.0.filter.fa --sizeout --output clusterITS_tmp/clusterITS.EE1.0.derep.fa --threads 1
[11/24/22 16:04:20]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Dereplicating file clusterITS_tmp/clusterITS.EE1.0.filter.fa 100%
4900349650 nt in 14000999 seqs, min 350, max 350, avg 350
Sorting 100%
3337643 unique sequences, avg cluster 4.2, median 1, max 177163
Writing FASTA output file 100%

[11/24/22 16:04:27]: 3,337,643 reads passed
[11/24/22 16:04:27]: vsearch --sortbysize clusterITS_tmp/clusterITS.EE1.0.derep.fa --minsize 2 --output clusterITS_tmp/clusterITS.EE1.0.sort.fa --threads 1
[11/24/22 16:04:38]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file clusterITS_tmp/clusterITS.EE1.0.derep.fa 100%
1168175050 nt in 3337643 seqs, min 350, max 350, avg 350
Getting sizes 100%
Sorting 100%
Median abundance: 2
Writing output 100%

[11/24/22 16:04:38]: Clustering OTUs (VSEARCH --cluster_smallmem)
[11/24/22 16:04:38]: vsearch --cluster_smallmem clusterITS_tmp/clusterITS.EE1.0.sort.fa --relabel OTU --usersort --sizeout --id 0.97 --centroids clusterITS_tmp/clusterITS.EE1.0.smallmem.otus.fa --threads 128
[11/24/22 16:10:55]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file clusterITS_tmp/clusterITS.EE1.0.sort.fa 100%
303732100 nt in 867806 seqs, min 350, max 350, avg 350
Masking 100%
Counting k-mers 100%
Clustering 100%
Sorting clusters 100%
Writing clusters 100%
Clusters: 35169 Size min 1, max 12734, avg 24.7
Singletons: 15400, 1.8% of seqs, 43.8% of clusters

[11/24/22 16:10:55]: De novo Chimera detection (VSEARCH --uchime_denovo)
[11/24/22 16:10:55]: vsearch --uchime_denovo clusterITS_tmp/clusterITS.EE1.0.smallmem.otus.fa --sizein --nonchimeras clusterITS_tmp/clusterITS.EE1.0.otus.fa
[11/24/22 16:12:41]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file clusterITS_tmp/clusterITS.EE1.0.smallmem.otus.fa 100%
12309150 nt in 35169 seqs, min 350, max 350, avg 350
Masking 100%
Sorting by abundance 100%
Counting k-mers 100%
Detecting chimeras 100%
Found 6558 (18.6%) chimeras, 28396 (80.7%) non-chimeras,
and 215 (0.6%) borderline sequences in 35169 unique sequences.
Taking abundance information into account, this corresponds to
24155 (2.8%) chimeras, 841990 (97.0%) non-chimeras,
and 1661 (0.2%) borderline sequences in 867806 total sequences.

[11/24/22 16:12:41]: 28,396 OTUs
[11/24/22 16:12:41]: Cleaning up padding from OTUs
[11/24/22 16:12:42]: Chimera Filtering (VSEARCH) using ITS DB
[11/24/22 16:12:42]: vsearch --mindiv 1.0 --uchime_ref clusterITS_tmp/clusterITS.EE1.0.clean.otus.fa --db /opt/miniconda3/miniconda3/envs/amptk/lib/python3.9/site-packages/amptk/DB/ITS.extracted.fa --nonchimeras clusterITS_tmp/clusterITS.EE1.0.uchime.otus.fa --threads 128
[11/24/22 16:21:47]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file /opt/miniconda3/miniconda3/envs/amptk/lib/python3.9/site-packages/amptk/DB/ITS.extracted.fa 100%
842996461 nt in 1389964 seqs, min 100, max 6778, avg 606
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Detecting chimeras 100%
Found 1292 (4.5%) chimeras, 26947 (94.9%) non-chimeras,
and 157 (0.6%) borderline sequences in 28396 unique sequences.
Taking abundance information into account, this corresponds to
1292 (4.5%) chimeras, 26947 (94.9%) non-chimeras,
and 157 (0.6%) borderline sequences in 28396 total sequences.

[11/24/22 16:21:47]: 26,947 OTUs passed, 1,449 ref chimeras
[11/24/22 16:21:47]: Validating OTU orientation
[11/24/22 16:21:47]: vsearch --usearch_global clusterITS_tmp/clusterITS.EE1.0.sort.fa --db clusterITS_tmp/clusterITS.EE1.0.uchime.otus.fa --sizein --id 0.97 --strand plus --uc clusterITS_tmp/orient.uc
[11/24/22 16:22:53]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file clusterITS_tmp/clusterITS.EE1.0.uchime.otus.fa 100%
9431399 nt in 26947 seqs, min 343, max 350, avg 350
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Searching 100%
Matching unique query sequences: 831343 of 867806 (95.80%)
Matching total query sequences: 11256580 of 11531162 (97.62%)

[11/24/22 16:22:55]: vsearch --usearch_global clusterITS_tmp/clusterITS.EE1.0.uchime.otus.fa --db clusterITS_tmp/clusterITS.EE1.0.uchime.otus.fa --self --id 0.95 --strand both --userout clusterITS_tmp/orient-map.txt --userfields query+target+qstrand+id
[11/24/22 16:23:02]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file clusterITS_tmp/clusterITS.EE1.0.uchime.otus.fa 100%
9431399 nt in 26947 seqs, min 343, max 350, avg 350
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Searching 100%
Matching unique query sequences: 11027 of 26947 (40.92%)

[11/24/22 16:23:02]: Dropping 8 OTUs: OTU13528, OTU15361, OTU31832, OTU17389, OTU25053, OTU33930, OTU24595, OTU31012
[11/24/22 16:23:03]: 26,939 OTUs validated (8 dropped)
[11/24/22 16:23:03]: Mapping Reads to OTUs and Building OTU table
[11/24/22 16:23:03]: vsearch --usearch_global clusterITS_tmp/clusterITS.orig.fa --strand plus --id 0.97 --db clusterITS_tmp/clusterITS.passed.otus.fa --uc clusterITS_tmp/clusterITS.EE1.0.mapping.uc --otutabout clusterITS_tmp/clusterITS.EE1.0.otu_table.txt --threads 128
[11/24/22 17:03:16]: vsearch v2.21.1_linux_x86_64, 1003.6GB RAM, 128 cores
https://github.com/torognes/vsearch

Reading file clusterITS_tmp/clusterITS.passed.otus.fa 100%
9428599 nt in 26939 seqs, min 343, max 350, avg 350
Masking 100%
Counting k-mers 100%
Creating k-mer index 100%
Searching 100%
Matching unique query sequences: 22802818 of 28800535 (79.17%)
Writing OTU table (classic) 100%

[11/24/22 17:03:21]: 22,802,818 reads mapped to OTUs (79%)
